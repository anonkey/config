#!/bin/zsh
# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    projgen.sh                                         :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: tseguier <marvin@42.fr>                    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2014/11/22 20:21:14 by tseguier          #+#    #+#              #
#    Updated: 2014/11/22 20:21:14 by tseguier         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #


lastarg=`echo "$*" | rev | cut -d ' ' -f1,1 |rev`
isLib=0
if [ $# = 0 ]
then
	echo "usage: projgen [-L] [-l libname] projname"
	exit 2
fi

# On récupère la valeur dernier argument grâce à ${}  
# et une référence indirecte sur le nombre d'argument 

echo "Create Project $lastarg";
echo "Create Main Directory";
mkdir $lastarg && cd $lastarg || return
echo "Create src && include";
mkdir src && mkdir include || return ;


while getopts :Ll: OPTION
do
	case "$OPTION" in
		"-L")
			echo "Project is a library";
			isLib=1;
			shift;;
		"l")
			tmp=`echo $2 | tail -c+3`
			echo "Create lib/lib$tmp";
			mkdir -p "lib/lib$tmp" || return ;
			shift
			shift
			;;
		"--")
			shift;
			break;
			;;
		":")
			echo "L'option $OPTARG requiert un argument"
			exit 5
			;;
		"?")
			echo "Option incorrecte,... "
			exit 3
			;;
		*)
			echo UKN" $i"
			;;
	esac
done
echo "generate Makefile"
if [ $isLib -eq 1 ]
then
	makegen -L
else
	makegen
fi
